<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org/">
<head th:replace="~{fragments/head :: head}"></head>
<style>
</style>
    <body>
        <div class="home-001">
            <div th:if="${user == null}"><nav th:replace="~{fragments/component-nav01 :: nav}"></nav></div>
            <div th:if="${user != null}"><nav th:replace="~{fragments/component-nav-03 :: nav}"></nav></div>
            <div th:if="${user != null}" id="user-id" th:data-userId="${user.id}"></div>
            <div id="liveAlertPlaceholder"></div>
            <main class="main">
                <div class="advertisements"></div>
                <div class="header-search">
                    <p class="title-catalog">Cat√°logo</p>
                    <form action="/" method="get" class="component-search">
                        <input name="text" class="bar-search">
                            <button type="submit" class="btn-search">
                                <svg class = elements-icons width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M19.375 17.5H18.3875L18.0375 17.1625C19.3048 15.6925 20.0014 13.8159 20 11.875C20 10.268 19.5235 8.69715 18.6307 7.361C17.7379 6.02485 16.469 4.98344 14.9843 4.36848C13.4997 3.75352 11.866 3.59262 10.2899 3.90612C8.7138 4.21963 7.26606 4.99346 6.12976 6.12976C4.99346 7.26606 4.21963 8.7138 3.90612 10.2899C3.59262 11.866 3.75352 13.4997 4.36848 14.9843C4.98344 16.469 6.02485 17.7379 7.361 18.6307C8.69715 19.5235 10.268 20 11.875 20C13.8875 20 15.7375 19.2625 17.1625 18.0375L17.5 18.3875V19.375L23.75 25.6125L25.6125 23.75L19.375 17.5ZM11.875 17.5C8.7625 17.5 6.25 14.9875 6.25 11.875C6.25 8.7625 8.7625 6.25 11.875 6.25C14.9875 6.25 17.5 8.7625 17.5 11.875C17.5 14.9875 14.9875 17.5 11.875 17.5Z" fill="#2042EA"/>
                                </svg>
                            </button>
                        </input>
                    </form>
                </div>

                <aside class="category-tree-container">
                    <div class="category-tree">
                        <ul class="tree">
                            <li id="category" th:each="category : ${categories}">
                                <label  th:for="'category' + ${category.id}" th:text="${category.name}"></label>
                                <ul class="subtree" th:if="${category.subcategories != null and category.subcategories.size() > 0}">
                                    <li th:each="subcategory : ${category.subcategories}">

                                        <input type="checkbox" th:id="'subcategory' + ${subcategory.id}" onchange="updateChecked(this)" />
                                        <label th:for="'subcategory' + ${subcategory.id}" th:text="${subcategory.name}"></label>
                                        <ul class="subsubtree" th:if="${subcategory.subcategories != null and subcategory.subcategories.size() > 0}">
                                            <li th:each="subsubcategory : ${subcategory.subcategories}">
                                                <input type="checkbox" th:id="'subsubcategory' + ${subsubcategory.id}" onchange="updateChecked(this)" />
                                                <label th:for="'subsubcategory' + ${subsubcategory.id}" th:text="${subsubcategory.name}"></label>
                                            </li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </aside>
                <script th:inline="javascript">
                    var selectedNames = [];

                    function updateChecked(checkbox) {
                        var name = checkbox.nextElementSibling.textContent.trim();
                        if (checkbox.checked) {
                            selectedNames.push(name);
                        } else {
                            var index = selectedNames.indexOf(name);
                            if (index !== -1) {
                                selectedNames.splice(index, 1);
                            }
                        }
                        console.log(selectedNames);
                    }
                </script>

                <div class="scrollbar-1">
                    <div class="box-image" >
                        <div class="component-card" th:each="book: ${books}">
                            <div class="rectangle-25">
                                <div  type="button" th:if="${user != null}">
                                    <div type="button" id="btn-loan" th:data-bookid = "@{${book.getId()}}" onclick="createLoan(this.getAttribute('data-bookid'))">
                                        <div th:replace="~{fragments/element-icon-loan-false :: div}"></div>
                                        <div id="loan">Reservar</div>
                                    </div>
                                </div>
                                <a th:href="@{/book/{id}(id=${book.getId()})}">
                                    <div class="image-container">
                                        <img class="img-book" th:src="@{${book.getImage()}}" alt="image-@{${book.getTitle()}}"/>
                                    </div>
                                    <div class="frame-14"></div>
                                    <div class="title" th:text="@{${book.getTitle()}}"></div>
                                    <div class="author" th:text="@{${book.getAuthorsNames()}}"></div>
                                    <div id="book-id" th:data-bookId="@{${book.getId()}}"></div>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </body>
</html>